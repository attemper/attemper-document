<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>任务 | Attemper</title>
    <meta name="description" content="分布式、多租户的支持流程编排的任务调度应用">
    <link rel="icon" href="/attemper-document/favicon.ico">
    
    <link rel="preload" href="/attemper-document/assets/css/0.styles.246b4e01.css" as="style"><link rel="preload" href="/attemper-document/assets/js/app.8c87566b.js" as="script"><link rel="preload" href="/attemper-document/assets/js/13.88d17a7e.js" as="script"><link rel="preload" href="/attemper-document/assets/js/4.3c27af22.js" as="script"><link rel="prefetch" href="/attemper-document/assets/js/10.07bd873f.js"><link rel="prefetch" href="/attemper-document/assets/js/11.7e602d59.js"><link rel="prefetch" href="/attemper-document/assets/js/12.8f037305.js"><link rel="prefetch" href="/attemper-document/assets/js/14.1f90e0cb.js"><link rel="prefetch" href="/attemper-document/assets/js/15.4d0aff7c.js"><link rel="prefetch" href="/attemper-document/assets/js/16.2df5b190.js"><link rel="prefetch" href="/attemper-document/assets/js/17.3d032cd2.js"><link rel="prefetch" href="/attemper-document/assets/js/18.b032a707.js"><link rel="prefetch" href="/attemper-document/assets/js/19.b49c2a02.js"><link rel="prefetch" href="/attemper-document/assets/js/3.4095f6ac.js"><link rel="prefetch" href="/attemper-document/assets/js/5.8e759067.js"><link rel="prefetch" href="/attemper-document/assets/js/6.263d8433.js"><link rel="prefetch" href="/attemper-document/assets/js/7.9fd63de0.js"><link rel="prefetch" href="/attemper-document/assets/js/8.97ff9d79.js"><link rel="prefetch" href="/attemper-document/assets/js/9.2ce520e7.js"><link rel="prefetch" href="/attemper-document/assets/js/vendors~docsearch.da6f705c.js">
    <link rel="stylesheet" href="/attemper-document/assets/css/0.styles.246b4e01.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/attemper-document/" class="home-link router-link-active"><!----> <span class="site-name">Attemper</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/attemper-document/guide/" class="nav-link">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">模块</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>调度管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/job.html" class="nav-link router-link-exact-active router-link-active">任务</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/delay-job.html" class="nav-link">延迟任务</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/arg.html" class="nav-link">参数</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/datasource.html" class="nav-link">数据源</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/calendar.html" class="nav-link">日历</a></li></ul></li><li class="dropdown-item"><h4>监控告警</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/attemper-document/feature/monitor/monitor.html" class="nav-link">执行监控</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/monitor/retry.html" class="nav-link">重试监控</a></li></ul></li><li class="dropdown-item"><h4>应用管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/attemper-document/feature/application/project.html" class="nav-link">项目</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/application/gist.html" class="nav-link">代码片段</a></li></ul></li><li class="dropdown-item"><h4>系统管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/attemper-document/feature/system/tenant.html" class="nav-link">多租户</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Language</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/attemper-document/feature/dispatch/job.html" class="nav-link router-link-exact-active router-link-active">中文</a></li><li class="dropdown-item"><!----> <a href="/attemper-document/en/" class="nav-link">en-US</a></li></ul></div></div> <a href="https://github.com/attemper/attemper" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/attemper-document/guide/" class="nav-link">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">模块</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>调度管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/job.html" class="nav-link router-link-exact-active router-link-active">任务</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/delay-job.html" class="nav-link">延迟任务</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/arg.html" class="nav-link">参数</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/datasource.html" class="nav-link">数据源</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/dispatch/calendar.html" class="nav-link">日历</a></li></ul></li><li class="dropdown-item"><h4>监控告警</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/attemper-document/feature/monitor/monitor.html" class="nav-link">执行监控</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/monitor/retry.html" class="nav-link">重试监控</a></li></ul></li><li class="dropdown-item"><h4>应用管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/attemper-document/feature/application/project.html" class="nav-link">项目</a></li><li class="dropdown-subitem"><a href="/attemper-document/feature/application/gist.html" class="nav-link">代码片段</a></li></ul></li><li class="dropdown-item"><h4>系统管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/attemper-document/feature/system/tenant.html" class="nav-link">多租户</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Language</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/attemper-document/feature/dispatch/job.html" class="nav-link router-link-exact-active router-link-active">中文</a></li><li class="dropdown-item"><!----> <a href="/attemper-document/en/" class="nav-link">en-US</a></li></ul></div></div> <a href="https://github.com/attemper/attemper" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav> <div class="load-success"><!----></div> <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>调度管理</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/attemper-document/feature/dispatch/job.html" class="active sidebar-link">任务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#任务节点" class="sidebar-link">任务节点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#http-任务" class="sidebar-link">Http 任务</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#sql-任务" class="sidebar-link">Sql 任务</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#ftp-任务" class="sidebar-link">Ftp 任务</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#邮件任务" class="sidebar-link">邮件任务</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#shell-bash" class="sidebar-link">Shell-Bash</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#shell-cmd" class="sidebar-link">Shell-Cmd</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#groovy" class="sidebar-link">Groovy</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#python-perl-ruby-等" class="sidebar-link">Python/Perl/Ruby 等</a></li></ul></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#触发器" class="sidebar-link">触发器</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#项目" class="sidebar-link">项目</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#参数" class="sidebar-link">参数</a></li><li class="sidebar-sub-header"><a href="/attemper-document/feature/dispatch/job.html#条件" class="sidebar-link">条件</a></li></ul></li><li><a href="/attemper-document/feature/dispatch/delay-job.html" class="sidebar-link">延迟任务</a></li><li><a href="/attemper-document/feature/dispatch/arg.html" class="sidebar-link">参数</a></li><li><a href="/attemper-document/feature/dispatch/datasource.html" class="sidebar-link">数据源</a></li><li><a href="/attemper-document/feature/dispatch/calendar.html" class="sidebar-link">日历</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>应用管理</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/attemper-document/feature/application/project.html" class="sidebar-link">项目管理</a></li><li><a href="/attemper-document/feature/application/gist.html" class="sidebar-link">代码片段</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>监控管理</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/attemper-document/feature/monitor/monitor.html" class="sidebar-link">执行监控</a></li><li><a href="/attemper-document/feature/monitor/retry.html" class="sidebar-link">重试监控</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>系统管理</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/attemper-document/feature/system/tenant.html" class="sidebar-link">租户</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="任务"><a href="#任务" class="header-anchor">#</a> 任务</h1> <h2 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h2> <p>任务是调度中心执行的入口，任务由 <code>bpmn-js</code> 通过拖拽的方式对任务节点进行设计，对任务形成流式编排。</p> <p>通过任务编排，可以实现以下一些典型的需求</p> <ul><li><p>串行
节点按线条指向先后执行</p></li> <li><p>并发
一批节点可以并发执行后汇聚</p></li> <li><p>分支判断
根据参数判断条件，改变后续执行的走向</p></li></ul> <h2 id="任务节点"><a href="#任务节点" class="header-anchor">#</a> 任务节点</h2> <p>任务节点，指任务中的一个节点，是调度中心的基本执行单元，它是由 <code>bpmn2.0</code> 的基本元素以及本项目的一些扩展定制的元素实现的。</p> <p>当前，我们支持以下任务节点类型</p> <ul><li>服务任务节点
<ul><li>Http 任务
<ul><li>同步任务</li> <li>异步任务</li></ul></li> <li>Sql 任务</li> <li>Ftp 任务</li> <li>邮件任务</li></ul></li> <li>脚本任务节点<br>
可以直接执行脚本代码或文件
<ul><li><code>Shell</code> <ul><li><code>Bash</code>
Linux 上的 shell 脚本</li> <li><code>Cmd</code>
Windows 上的命令行脚本</li></ul></li> <li><code>Groovy</code></li> <li><code>Python</code>/<code>Perl</code>/<code>Ruby</code>等</li></ul></li></ul> <h3 id="http-任务"><a href="#http-任务" class="header-anchor">#</a> Http 任务</h3> <h4 id="spring-boot-mvc-框架"><a href="#spring-boot-mvc-框架" class="header-anchor">#</a> spring(boot/mvc)框架 <span class="badge tip top" data-v-099ab69c>sdk1.0.0</span></h4> <p>使用此类框架的任务，应使用调度中心提供的 sdk</p> <ul><li>spring boot</li></ul> <p><a href="https://github.com/attemper/attemper-samples/tree/master/attemper-samples-spring-boot" target="_blank" rel="noopener noreferrer">Spring Boot 项目对接示例<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="tip custom-block"><p class="custom-block-title">框架依赖</p> <p>JDK1.8 SpringBoot&gt;=1.3.x</p></div> <div class="language-Markup line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-markup"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sdk.version</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sdk.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.attemper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>attemper-java-sdk-micro-executor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${sdk.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>引入自动配置类:<a href="https://github.com/attemper/attemper-samples/blob/master/attemper-samples-spring-boot/src/main/java/com/github/attemper/samples/SampleApplication.java" target="_blank" rel="noopener noreferrer">参考启动类配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-Java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>attemper<span class="token punctuation">.</span>java<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>micro<span class="token punctuation">.</span>executor<span class="token punctuation">.</span>conf</span><span class="token punctuation">.</span><span class="token class-name">ExecutorAutoConfiguration</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token class-name">ExecutorAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>spring mvc</li></ul> <p><a href="https://github.com/attemper/attemper-samples/tree/master/attemper-samples-spring" target="_blank" rel="noopener noreferrer">Spring MVC 项目对接示例<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="tip custom-block"><p class="custom-block-title">框架依赖</p> <p>JDK&gt;=1.6 Spring&gt;=3.x</p></div> <div class="language-Markup line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-markup"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sdk.version</span><span class="token punctuation">&gt;</span></span>1.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sdk.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.attemper<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>attemper-java-sdk-rest-executor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${sdk.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>引入自动配置类:<a href="https://github.com/attemper/attemper-samples/blob/master/attemper-samples-spring/src/main/java/com/github/attemper/samples/spring/conf/ExecutorConfiguration.java" target="_blank" rel="noopener noreferrer">参考配置类<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-Java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>attemper<span class="token punctuation">.</span>java<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>rest<span class="token punctuation">.</span>conf</span><span class="token punctuation">.</span><span class="token class-name">RestConfiguration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>attemper<span class="token punctuation">.</span>java<span class="token punctuation">.</span>sdk<span class="token punctuation">.</span>rest<span class="token punctuation">.</span>executor<span class="token punctuation">.</span>conf</span><span class="token punctuation">.</span><span class="token class-name">RestExecutorConfiguration</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token class-name">RestConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
        <span class="token class-name">RestExecutorConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">ExecutorRestClient</span> <span class="token function">executorRestClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ExecutorRestClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>spring boot/mvc 项目开发任务是通用的，原理是执行器通过调用 sdk 暴露的路由接口，以反射的方式调用 Bean 中的方法</p> <div class="tip custom-block"><p class="custom-block-title">调用机制</p> <p>同步调用:调度中心与被调用系统保持双向连接，直到任务执行结束或超时<br>
异步调用:调度中心在调用后，即进行锁等待，被调用系统需在任务执行结束或超时后，通知调度中心</p></div> <p>sdk 中为接入的系统提供了四个任务模板接口<br>
所在包：<code>com.github.attemper.java.sdk.rest.executor.template</code></p> <table><thead><tr><th style="text-align:left">接口名</th> <th>参数</th> <th>返回值</th></tr></thead> <tbody><tr><td style="text-align:left">Executing</td> <td>无</td> <td>无</td></tr> <tr><td style="text-align:left">ExecutingWithParam</td> <td>有</td> <td>无</td></tr> <tr><td style="text-align:left">ExecutingWithResult</td> <td>无</td> <td>有</td></tr> <tr><td style="text-align:left">ExecutingWithParamAndResult</td> <td>有</td> <td>有</td></tr></tbody></table> <p>而如果需要在一个 Bean 中调用多个方法，则不需要使用这些接口，直接声明 public 方法即可</p> <h4 id="其他-http-任务-非-java-语言的-spring-框架的-web-项目"><a href="#其他-http-任务-非-java-语言的-spring-框架的-web-项目" class="header-anchor">#</a> 其他 Http 任务(非 java 语言的 spring 框架的 web 项目)</h4> <p>支持以配置 http 的 url 的方式接入</p> <ul><li>请求类型
<ul><li>POST</li> <li>GET</li> <li>PUT</li> <li>DELETE</li></ul></li></ul> <p><a href="https://github.com/attemper/attemper-samples/blob/master/attemper-samples-task/src/main/java/com/github/attemper/samples/task/demo003/UriTaskController.java" target="_blank" rel="noopener noreferrer">URI 接入例子<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="sql-任务"><a href="#sql-任务" class="header-anchor">#</a> Sql 任务</h3> <p>执行器内置 Sql 任务，配置相应的数据源后，可在运行时执行 Sql 语句，目前支持</p> <ul><li>select
查询的结果集为
<ul><li>对象
字符串、整数等单行单列</li> <li>Map
单行多列</li> <li>List
多行多列</li></ul></li> <li>insert
执行插入语句</li> <li>update
执行更新语句</li> <li>delete
执行删除语句</li></ul> <p><a href="/attemper-document/feature/dispatch/arg.html#sql-语句-sql">Sql 参数</a></p> <h3 id="ftp-任务"><a href="#ftp-任务" class="header-anchor">#</a> Ftp 任务</h3> <p>执行器内置 FTP 任务，主要有一下功能</p> <ul><li>上传
将本地文件上传至 FTP 服务器</li> <li>下载
将 FTP 服务器上的文件下载到本地磁盘</li></ul> <h3 id="邮件任务"><a href="#邮件任务" class="header-anchor">#</a> 邮件任务</h3> <p>执行器内置邮件任务，抽取发送邮件的功能，有以下配置项</p> <blockquote><p>发送方:发送方的邮箱账号，为空时取系统级配置<code>spring.mail.username</code>的值<br>
接收方:接收方的邮箱账号，多个以,隔开<br>
邮件主题:邮件的标题<br>
邮件内容:邮件的正文内容，支持<code>Html</code>和模板语言<code>FreeMarker</code></p></blockquote> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>使用时请接收方注意邮件是否被视作垃圾邮件而存入垃圾箱中</p></div> <h3 id="shell-bash"><a href="#shell-bash" class="header-anchor">#</a> Shell-Bash</h3> <p>支持执行 Linux 的 Bash 脚本</p> <h3 id="shell-cmd"><a href="#shell-cmd" class="header-anchor">#</a> Shell-Cmd</h3> <p>支持执行 Windows 的 Cmd 脚本</p> <h3 id="groovy"><a href="#groovy" class="header-anchor">#</a> Groovy</h3> <p>支持执行 Groovy 脚本</p> <h3 id="python-perl-ruby-等"><a href="#python-perl-ruby-等" class="header-anchor">#</a> Python/Perl/Ruby 等</h3> <p>通过指定开发语言，支持执行其他脚本语言，如 Python/Perl/Ruby 等</p> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>若执行器在非容器环境启动，则应当在系统中安装相应的脚本执行环境<br>
若执行器以镜像方式启动，则必须自制包含 JRE8+和相应脚本执行环境的镜像</p></div> <h2 id="触发器"><a href="#触发器" class="header-anchor">#</a> 触发器</h2> <p>目前支持 4 种触发器</p> <ul><li><p>Cron 触发器</p> <ul><li>Quartz 框架原生支持，使用广泛</li> <li>配置 Cron 表达式，比如<code>0 0 12 * * ?</code> <code>0 0/5 * * * ?</code></li> <li>调度中心提供在线配置工具，辅助配置 Cron 表达式</li></ul></li> <li><p>日程偏移触发器</p> <ul><li>本项目扩展，主要用来支持与日历相关的时间节点调度，比如每周/月/年的第一个交易日等</li> <li>应用场景：周报、月报、半年报、年报的发送；定点推送等</li></ul></li> <li><p>每日周期触发器</p> <ul><li>Quartz 框架原生支持，主要是解决 Cron 表达式的局限</li> <li>支持在每一天设置开始和结束时刻，如上午 9:30 到下午 15:00</li> <li>支持跨越时间单位，如每 90 分钟</li></ul></li> <li><p>日历周期触发器</p> <ul><li>Quartz 框架原生支持，使用较少</li> <li>支持比如从设置的开始时间起，每隔一天/周/月/年执行一次</li></ul></li></ul> <h2 id="项目"><a href="#项目" class="header-anchor">#</a> 项目</h2> <p>对于 HTTP 任务来说，因为需要调用接入的系统，所以要绑定被调系统的配置(地址)，调度中心支持为任务绑定 1 个项目。</p> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>任务不指定项目时，调度中心默认会找项目的根服务的配置</p></div> <p>参见<a href="/attemper-document/feature/application/project.html">项目管理</a></p> <h2 id="参数"><a href="#参数" class="header-anchor">#</a> 参数</h2> <p>在任务中使用参数，有以下一些场景:</p> <ul><li><p>参数注入</p> <ul><li>运行时执行器将参数传递给接入的系统(HTTP 任务)</li> <li>运行时将参数传递给脚本任务(比如 Shell、Python 任务)</li></ul></li> <li><p>参数传递</p> <ul><li>运行时替换任务的配置(比如按日期生成的文件目录)</li> <li>前置任务执行结果作为参数，传递给后置任务</li></ul></li></ul> <p>参见<a href="/attemper-document/feature/dispatch/arg.html">参数管理</a></p> <h2 id="条件"><a href="#条件" class="header-anchor">#</a> 条件</h2> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>在某些场景，每日只执行一次的任务配置成轮询是不得已的，因为任务上下游或者自身的依赖在起初并不满足。</p></div> <p>本项目将这种需求抽取为依赖<strong>条件</strong>，目前抽取了三种依赖条件:</p> <ul><li>SQL
在所配数据源中，执行 SQL 语句，能够查到数据则视为满足条件</li> <li>FTP 文件
在所配服务器中检测文件是否存在(生成)，存在则视为满足条件</li> <li>本地文件
在执行该任务的执行器本地(若执行器由 Docker 启动，可能需要挂载)检测文件是否存在，存在则视为满足条件</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/ldang264/attemper-document/edit/master/docs/feature/dispatch/job.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/attemper-document/feature/dispatch/delay-job.html">
          延迟任务
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/attemper-document/assets/js/app.8c87566b.js" defer></script><script src="/attemper-document/assets/js/13.88d17a7e.js" defer></script><script src="/attemper-document/assets/js/4.3c27af22.js" defer></script>
  </body>
</html>
